<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Transaction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .note-label {
            font-weight: bold;
            font-size: 18px;
        }
        .total-display {
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container mt-5">
        <h2 class="text-center mb-4">üíµ Add Cash Transaction</h2>
        <form method="POST" id="cashForm">
            <div class="row g-3">
                <!-- Date -->
                <div class="col-md-6">
                    <label for="date" class="form-label">üóìÔ∏è Date</label>
                    <input type="date" class="form-control" name="date" id="date" required>
                </div>

                <!-- Type -->
                <div class="col-md-6">
                    <label for="type" class="form-label">üìå Type</label>
                    <select class="form-select" name="type" required>
                        <option value="Income">Income</option>
                        <option value="Expense">Expense</option>
                    </select>
                </div>
            </div>

            <hr>

            <!-- Denominations -->
            <h5 class="mt-3">üí∞ Cash Notes</h5>
            <div class="row row-cols-1 row-cols-md-2 g-2">
                {% for value in [500, 200, 100, 50, 20, 10, 5, 2, 1] %}
                <div class="col">
                    <label class="note-label">‚Çπ{{ value }}</label>
                    <div class="input-group">
                        <input type="number" class="form-control note-count" data-value="{{ value }}" value="0" min="0">
                        <span class="input-group-text">√ó ‚Çπ{{ value }} = ‚Çπ</span>
                        <span class="input-group-text result-value">0</span>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Total -->
            <div class="mt-4 text-end">
                <span class="total-display">Total: ‚Çπ<span id="totalAmount">0</span></span>
            </div>

            <!-- Hidden category and amount fields -->
            <input type="hidden" name="category" value="Cash Bundle">
            <input type="hidden" name="amount" id="amount">
            <div class="mt-3">
                <label class="form-label">üìù Notes</label>
                <input type="text" class="form-control" name="notes" placeholder="Optional">
            </div>

            <!-- Buttons -->
            <div class="mt-4 d-flex justify-content-between">
                <a href="/" class="btn btn-secondary">‚Üê Back</a>
                <button type="submit" class="btn btn-primary">‚úÖ Save Transaction</button>
            </div>
        </form>
    </div>

    <script>
        // Auto-fill today's date
        document.getElementById('date').valueAsDate = new Date();

        const counts = document.querySelectorAll('.note-count');
        const amountField = document.getElementById('amount');
        const totalSpan = document.getElementById('totalAmount');

        counts.forEach(input => {
            input.addEventListener('input', calculateTotal);
        });

        function calculateTotal() {
            let total = 0;
            counts.forEach((input, i) => {
                const val = parseInt(input.value || 0);
                const mul = parseInt(input.dataset.value);
                const rowTotal = val * mul;
                total += rowTotal;
                input.parentElement.querySelector('.result-value').textContent = rowTotal;
            });
            totalSpan.textContent = total;
            amountField.value = total;
        }

        calculateTotal();
    </script>
</body>
</html>
